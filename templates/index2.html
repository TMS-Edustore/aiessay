<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Theory Marker</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.1/socket.io.js"></script>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <h1>Student Answer Grading</h1>
    
    <form id="uploadForm" action="/readfile" method="post" enctype="multipart/form-data">
        <label for="file">Upload Student Response data:</label><br>
        <input type="file" name="file" accept=".xlsx"> 
        <button type="submit">Upload</button>
    </form>

    <div id="progress">0%</div>

    {% if score is not none %}
        <h2>Grading Result</h2>
        <p><strong>Score:</strong> {{ score }}</p>
        <p><strong>Reason:</strong> {{ reason }}</p>
    {% endif %}

    <script>
        var socket = io.connect('http://' + document.domain + ':' + location.port);
        // console.log("connected to server",socket)
        // document.getElementById('progress').innerText = 4+ "%";
        socket.on('connect', function() {
            console.log('Connected to server');
            // socket.emit('checkData');
        })
        setInterval(() => {
            // emit checkdata here
            socket.emit('checkData');

            console.log("Emitting checkdata...");
        }, 5000); // 5000 milliseconds = 5 seconds

        socket.on('message', function(data) {
            console.log('message from server', data.message);
        })
        socket.on('update', function(data) {
            console.log('checked server', data.data);
        })


        socket.on('progress_update', function(data) {
            console.log("progress updated",data.progress)
            document.getElementById('progress').innerText = data.progress + "%";
        });

    
    </script>
</body>
</html>
